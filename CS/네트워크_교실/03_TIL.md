## IP 어드레싱

------

### 3계층의 역할과 개요



__네트워크 __

​	라우터와 라우터로 분배된 컴퓨터 그룹 / 세그먼트 간에서의 데이터 송수신

라우터를 넘어서는 브로드캐스트는 송신되지 않음 (즉 세그먼트를 넘어서는 ...)

즉 라우터를 통해 브로드캐스트가 도달하는 범위를 한정한다

3계층에서는 인터넷 작업을 실행

------



### 인터넷 프로토콜



인터넷 작업을 하기 위해 __어드레싱__을 진행

어디에 있는지와 같은 논리 주소를 부여

라우팅(routing)을 통해 수싵처까지 어떤 경로로 갈 지를 결정



어드레싱 하고 라우팅 하기 위한 프로토콜을 IP(Internet Protocol)라고 한다

- IPv4 / IPv6



캡슐화에서 IP헤더를 붙인 PDU를 __IP 데이터 그램__

------



### IP주소 



논리 주소는 계층형 주소 

네트워크 관리자가 컴퓨터에 할당

네트워크에 접속할 때마다 논리 주소를 붙임 / 즉, 소속된 네트워크가 변경되면 논리 주소 역시 바뀜

- IPv4 (이를 기준으로 설명)
  - 유니캐스트, 브로드캐스트, 멀티캐스트
- IPv6
  - 유니캐스트, 멀티캐스트, 애니캐스트



네트워크 번호는 접속되어 있는 모든 네트워크에서 유일

컴퓨터 번호는 네트워크 내에서 유일



#### IP 주소

32비트로 네트워크 번호의 컴퓨터 번호를 나타냄

8비트를 1옥텟으로 하여 4개의 옥텟으로 표기

__클래스__

A B C 로 구성

첫 번째  옥텟은 네트워크 번호 / 나머지가 컴퓨터 번호

- A = 0xxxxxxx
- B = 10xxxxxx
- C = 110xxxxx
- D = 1110xxxx
- E = 1111xxxx

보통 DE클래스는 사용하지 않음

식별하는 비트를 제외하고 나머지 모든 비트를 네트워크 어드레싱에 사용한다

따라서 A가 가장 많은 IP를 보유

클래스로 나누어 IP 주소를 할당하는 방식을 __클래스풀 어드레싱__

- 할당 해서는 안되는 주소
  - 4옥텟 00000000 - 네트워크 주소
  - 4옥텟 11111111 - 브로드캐스트 주소

------



### 서브네팅(Subnetwork)

> 큰 네트워크를 작은 네트워크로 분할

네트워크는 계층형 주소로 이루어져 있기 때문에 큰 네트워크 안에 작은 네트워크를 생성 가능

호스트 번호 일부를 줄여 서브넷 번호를 만든다. 따라서 서브넷의 번호를 크게 하면 호스트 수는 감소

- 6비트의 서브넷 번호와 10비트의 호스트 번호

서브넷은 그 네트워크의 내부에서만 유효함



#### 서브넷 마스크(Subnetmask)

> IP주소의 어느 부분까지가 서브넷 번호인지를 나타냄 / 비트열을 IP 주소와 동시에 표기

IP주소와 같이 32비트 네트워크 번호 서브넷 번호를 모두 1로 호스트 번호를 0으로 표기한 비트열

IP주소와 반드시 세트로 같이 기술

------



### 클래스리스 어드레싱(Classless Adressing)



클래스라는 구분을 없앤 어드레싱 / 할당되징낳는 비효율성을 줄이기 위해 고안된 방법

#### 슈퍼넷

클래스 C 8개를 통합하여 2048개의 IP주소를 갖는 네트워크로 만듦

21비트를 네트워크 번호로 함



#### 프리픽스 길이(CIDR Classless Inter - Domain Routing)

네트워크 번호의 길이를 나타내는 값

서브넷마스크와 같은 역할을 한다. 따라서 같이 사용 가능(?)

192.168.32.0/21 주소 뒤에 슬래스를 넣고 네트워크 번호 비트 수(프리픽스 길이)를 기술

------



### DHCP(Dynamic Host Configuration Protocol)

> 자동으로 IP주소가 컴퓨터에 설정게 하는 프로토콜
>
> 할당할 IP주소를 관리하고, 실제로 할당 작업을 수행하는 서버하고 할당 받는 클라이언트로 이루어짐



이더넷을 사용해서 IP데이터그램을 송수신하기 위해서는 4개의 주소가 필요

- 수신처 MAC 주소
- 송신처 MAC 주소 - 송신할 인터페이스의 MAC 주소
- 수신처 IP 주소
- 송신처 IP 주소



__DHCP 서버__

​	설정된 IP주소 풀 중에서 요청한 클라이언트에게 각각 유일한 것이 되도록 주소를 할당

__대여 기간__

​	호스트에 문제가 생겼을 경우 IP가 점유되는 것을 방지하기 위해

__DHCP 메시지__

​	옵션을 통해 네트워크의 설정 정보도 보낼 수 있음

<img src="https://www.netmanias.com/ko/?m=attach&no=1987" style="zoom:80%;" />

브로드 캐스트를 통해 전체 수신으로 보냄



------



### ARP(Adress Resolution Protocol)



수신처의 MAC주소는 수신처의 IP주소가 결정된 이후에 결정

__ARP 테이블__

​	IP 주소와 MAC주소의 대응표

ARP 테이블에 수신처 IP와 MAC 주소의 대응이 있으면 수신처 MAC 주소를 알 수 있음

__ARP 요청__

​	테이블에 없는 경우 ARP를 통해 MAC주소를 요청해 오는 것

IP와 MAC의 대응이 달라질 수 있기 때문에 보통 300 유효가 만기됨

------



### DNS(Domain Name System)

> 이름과 IP주소를 대응시킨 시스템



DNS서버에 문의 해서 이름과 IP주소의 대응 데이터 베이스를 조회

DNS 서버는 각 조직에 1개씩 있음

다른 조직의 도메인 명에 대응하는 IP주소는 그 조직의 DNS 서버에 문의해서 입수



