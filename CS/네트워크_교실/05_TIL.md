## 커넥션과 포트 번호

------



### 4계층의 역할과 개요

4계층 이상에서는 전달할 / 전달된 데이터에 대해 필요한 처리를 함

4계층에서는 데이터가 중간에 손실 / 에러에 의해 파기 등의 에러 복구를 함

#### 흐름 제어

- 오버 플로우를 방지
  - 오버 플로우 - 처리 능력을 넘어선 정보를 받고 다 처리하지 못하면 데이터를 파기
  - 이를 방지하기 위해 수신측은 확인응답 때에 모아둘 수 있는 데이터 양을 송신처에 통지, 송신량을 가감하게 하거나 송신을 일시적으로 중지하게 함

#### 포트 번호

애플리케이션은 포트에 의해 통신기능과 접속되어 있다.

부여된 번호를 사용하여 어느 애플리케이션이 수신처인지를 판별한다.

------



### 커넥션과 세그먼트

#### 커넥션(Connection)

데이터의 길

TCP에서 만들어진 통신로는 가상적인 통신로

데이터 전송을 시작하기 전에 미리 확인을 주고받음

TCP 헤더의 크기는 20옥텟

#### 쓰리 웨이 핸드쉐이크

![](https://s3.ap-south-1.amazonaws.com/afteracademy-server-uploads/what-is-a-tcp-3-way-handshake-process-three-way-handshaking-establishing-connection-6a724e77ba96e241.jpg)

TCP는 애플리케이션으로 부터 받은 데이터를 세그먼트로 켭슐화함

MSS로 분할 / 각가의 세그먼트에 번호를 부여하고 이를 **시퀀스 번호**라고 함



------



### 윈도우 제어

#### 시퀀스 번호

에러 복구

##### 확인 응답

세그먼트를 수신하면, 수신한 것을 송신처에게 전달

시퀀스 번호는 보내는 데이터의 앞 부분에 있는 옥텟 번호이고, 확인응답 번호는 다음에 받고 싶은 데이터의 선두 옥텟 번호

이를 이용해 수신측이 어느 데이터까지 받았는지 확이가능

**RTT (Round Trip Time)**

지금까지 보낸 데이터에 대해 확인응답이 돌아오기까지 걸린 시간

#### 윈도우 제어

이를 효율이 더 좋게 하기 위해 복수의 세그먼트를 전송하고 확인 응답을 받는다.

데이터를 일시적으로 담을 버퍼가 존재

자신이 어느 정도 버퍼량을 가지고 있는지 **윈도우 사이즈**를 알려줌

##### 윈도우 사이즈

확인응답을 기다리지 않고 보낼 수 있는 데이터 양

------



### 포트 번호

#### 포트 번호

어느 애플리케이션으로부터 송신 되었는지 어느 애플리케이션 수신인지 결정

16 비트의 포트 번호로 데이터를 보낼 애플리케이션을 특정

수신처의 포트 번호를 모르면 데이터를 보낼 수 없다

수신 받을 애플리케이션이 포트와 접속해 있지 않으면, 데이터는 도달할 수 없다

**Server Application**은 사전에 정해진 번호를 사용함으로써 서비스를 제공할 수 있도록 함

![](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=http%3A%2F%2Fcfile6.uf.tistory.com%2Fimage%2F9953183E5B8FA49E0782C1)



------



### 라우팅 프로토콜

교환할 정보를 바탕으로 라우팅 테이블을 변경

#### 자율화 시스템(Autonomous System)

하나의 관리 단체에 의해 관리되는 네트워크 집합체

경로 도메인, 경로 제어 도메인

#### AS 간 라우팅 EGP(Exterior Gateway Protocol)

EGP - 디스턴스 벡터

BGP - 경로 벡터

#### AS 내 라우팅 IGP(Interior Gateway Protocol)

RIP - 디스턴스 벡터

OSPF - 링크상태

IS-IS - 링크상태

EIGRP - 하이브리드

정보교환을 언제 할지, 어떻게 할지, 누구에게 전송할지, 어떤 정보를 전송할지

------



### UDP

TCP는 정확 / 효율

UDP의 헤더에는 포트 번호 외에는 정보가 없다

확인 응답에 따른 시간이 필요 없어서 **고속 전송**

고속성이나 실시간 송수신이 필요한 애플리케이션에서 활용

브로드 캐스트에서도 UDP 활용

------



### 네트워크 주소 변환

**NAT (Network Address Translation) 네트워크 주소 변환**

IP주소의 고갈 문제를 해결하기 위한 방법

NAT에서 변환되는 주소는 유일해야함

보유하고 있는 글로벌 IP주소 수 이상의 호스트는 인터넷에 동시에 접속할 수 없음

발전모델은 NAPT

------



### NAPT(Network Address Port Translation)

포트 번호도 변환하여 하나의 글로벌 IP 주소로 복수의 컴퓨터를 접속 가능

보안도 강화

#### 정적 NAPT

NAPT 테이블에 저장되어 있지 않는 것은 LAN 내부로 들어오지 못함

테이블에 미리 변환을 저장시켜주면 해결 가능

이를 수동으로 변환

#### FTP(File Transfer Protocol)



### 5~7 계층

애플리케이션 층

#### 5계층

세션계층





