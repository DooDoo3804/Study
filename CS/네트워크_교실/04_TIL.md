## 라우팅

------



### 주소와 경로

#### MAC / IP

- MAC은 같은 네트워크 내에서의 수신처

- IP는 수신처의 컴퓨터

MAC 주소로 다음으로 보낼 장소를 지정 / 경유지와 같음

따라서 MAC주소는 변화하면서 다음 주소를 받음

#### 라우터

라우터가 다음 경로를 지정

라우터가 없으면 다른 네트워크에 데이터그램을 보낼 수 없음

#### 홉 바이 홉 (hop by hop) 통신

홉은 라우터를 의미

컴퓨터에 설정되어 있는 라우터는 디폴트 게이트웨이라 함

------



### 라우터

데이터그램의 수신처 IP주소를 근거로 다음에 송신하는 라우터를 결정

네트워크의 경계상에 존재하므로 복수의 인터페이스를 가질 수 있음

##### 필터링

전송받은 데이터그램에 조건을 붙여 그 데이터그램을 파기하는 것

#### 라우팅 테이블

최적 경로의 지도

수신처 네트워크까지의 거리, 다음에 도달하는 라우터, 그 라우터에 연결되어있는 자신의 인터페이스

__최장일치의 룰(Longest Match)__ 를 통해 다음 수신처를 찾음

- IP주소의 비트열과 네트워크 주소의 비트열을 앞에서부터 순서대로 비교해서 가장 많이 일치하는 것부터 선택

------



### 디폴트 게이트웨이

라우터가 네트워크를 나누기 때문에 브로드캐스트가 다른 네트워크에 송신되지 않게 함

이 범위를 __브로드캐스트__ 도메인

충돌 도메인은 스위치가 구분하고, 브로드캐스트 도메인은 라우터가 구분

라우터 끼리가 브로드캐스트 도메인

충돌 도메인은 라우터 밑 범위

#### 디폴트 게이트웨이

디폴트 게이트웨이로 데이터를 보내서 다른 네트워크로 전송

컴퓨터는 다른 네트워크에 데이터를 송신할 때 디폴트 게이트웨이로 ARP를 수행

------



### 라우팅

#### 라우팅 테이블

수신처 네트워크 / 중계지점 / 메트릭 / 수신처의 출구

수신처 네트워크 주소와 라우팅 테이블을 비교해서 경로를 찾음

수신처 불명이면 파기

##### 정적 라우팅 / 동적 라우팅

- 정적 : 사용자가 직접 입력
  - 단점 : 주소를 사용하지 못하게 되었을 때 관리자가 이를 수동으로 다시 설정해야함
- 동적 : 자동으로 정보를 서로 교환해서 경로를 알아냄
  - 단점 : 정보 교환은 곧 회선의 점유를 의미 / 저속 회선은 주의 필요
  - 서로 교환한 정보를 가지고 최적의 경로를 계산해야함 / 계산이 늦으면 전송이 늦어짐
  - 모든 라우터가 동일한 정보를 가져야함 (Convergence)

중복성(Redundancy) : 여분을 가지고 있어서 장애 등에 대비할 수 있음

------



### 라우팅 프로토콜

교환할 정보를 바탕으로 라우팅 테이블을 변경

#### 자율화 시스템(Autonomous System)

하나의 관리 단체에 의해 관리되는 네트워크 집합체

경로 도메인, 경로 제어 도메인

#### AS 간 라우팅 EGP(Exterior Gateway Protocol)

EGP - 디스턴스 벡터

BGP - 경로 벡터

#### AS 내 라우팅 IGP(Interior Gateway Protocol)

RIP - 디스턴스 벡터

OSPF - 링크상태

IS-IS - 링크상태

EIGRP - 하이브리드

정보교환을 언제 할지, 어떻게 할지, 누구에게 전송할지, 어떤 정보를 전송할지

------



### RIP

메트릭(Metric) - 최적의 경로를 결정할 때의 판단 기준

라우터의 수, 회선의 속도, 정체 상태, 에러 발생률

라우터가 다른 라우터와 교환하는 정보를 라우팅 업데이트라고 함(routing update)

- 30초에 한 번 라우팅 테이블을 그대로 교환
- 6번 수신하지 않으면 그 라우터에 장애가 있다고 간주 / 그 경로 모두 파기
- 홉 수 : 통과하는 라우터수

자기가 모르는 네트워크를 테이블에 추가

업데이트를 보내 온 라우터를 그 앞의 네트워크에의 중계 라우터로, 업데이트를 받은 인터페이스를 그 앞의 네트워크에의 송신인터페이스로 정함

------



### ICMP(Internet Control Message Protocol)

네트워크의 제어 / 관리에 사용되는 것

일반적으로 IP패킷의 [세그먼트와 데이터] 대신에 ICMP메시지가 들어간다

##### Query 메시지

상태를 조사하기 위해

##### Error 메시지 

에러를 통지하기 위함

![](https://t1.daumcdn.net/cfile/tistory/99484F335C5D694803)

##### TTL(Time To Live)

IP 데이터그램은 라우터를 경유할 때마다 1만큼씩 줄어들어 0이 되면 파기

무의미한 데이터가 네트워크 내에서 무한 루프 도는 것을 방지하기 위함

------



### Echo와 Time Exceeded

송신측은 에코 요청을 보내고, 수신한 컴퓨터는 에코 응답을 돌려 보냄

#### Ping

핑이 이개념을 사용

에코를 통해 송수신이 가능함을 알 수 있음

시간을 측정하여 네트워크 상태를 조사할 수 있음



#### Time Exceeded

시간초과에 의한 패킷 파기

##### traceroute

 타입 11을 사용한 네트워크의 체크용 소프트웨어

수신처까지의 경로를 가르쳐 주는 소프트웨어

송신처에 Time Exceeded를 전송

크래커에 의한 보안 주의
